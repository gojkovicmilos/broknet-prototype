

<div style="margin-top: 2rem">
    

    

    <mat-form-field appearance="outline">
        <mat-label>Label</mat-label>
        <input name ="input" type="text" placeholder="Choose Listing" [(ngModel)]="typed" (keyup)="onKey($event)" aria-label="Number" matInput [matAutocomplete]="auto">
        <mat-autocomplete #auto="matAutocomplete">
            <mat-option *ngFor="let listing of filteredListings" [value]="listing.symbol">
              {{listing.symbol}}: {{listing.companyName}}
            </mat-option>
        </mat-autocomplete>
    </mat-form-field>

    <button mat-button (click)="getNewApi(typed)">Add to Watchlist</button>



        <button mat-icon-button [matMenuTriggerFor]="basic">Sort By:
        </button>


    <mat-menu #basic="matMenu">
      <button mat-menu-item (click)="parameter = 'change_pct';sortStocks(parameter, ort)">Change Percentage</button>
      <button mat-menu-item (click)="parameter = 'price';sortStocks(parameter, ort)">Price</button>
      <button mat-menu-item (click)="parameter = 'name';sortStocks(parameter, ort)">Name</button>
    </mat-menu>

    <button mat-icon-button [matMenuTriggerFor]="basic1">Orientation:
      </button>


  <mat-menu #basic1="matMenu">
    <button mat-menu-item (click)="ort = 'asc';sortStocks(parameter, ort)">Ascending</button>
    <button mat-menu-item (click)="ort = 'desc';sortStocks(parameter, ort)">Descending</button>
  </mat-menu>

</div>




<div style="padding-right: 2rem; padding-left: 2rem; margin-bottom: 2rem">
        <mat-card *ngFor="let stock of stocks; let i=index" style="margin-bottom:2rem; max-width: 1000px;">
            <mat-card-header>
              
              <mat-icon mat-card-avatar style="color: green" *ngIf="stock.change_pct>0">arrow_drop_up</mat-icon>
              <mat-icon mat-card-avatar style="color: red" *ngIf="stock.change_pct<0">arrow_drop_down</mat-icon>
              <p mat-card-avatar style="color: green" *ngIf="stock.change_pct>0">+{{stock.change_pct}}%</p>
              <p mat-card-avatar style="color: red" *ngIf="stock.change_pct<0">{{stock.change_pct}}%</p>
              <!-- <mat-card-title>{{stock.name}}</mat-card-title> -->
              <mat-card-title>{{stock.symbol}}</mat-card-title>
              
            </mat-card-header>
            <mat-card-content>
            <mat-expansion-panel>
                <mat-expansion-panel-header>
                    <mat-panel-title>
                      {{stock.name}}
                    </mat-panel-title>
                  </mat-expansion-panel-header>
              <p>Trading at the {{stock.stock_exchange_long}}</p>

              <p>Previous Close: ${{stock.close_yesterday}}</p>
              <p>Open: ${{stock.price_open}}</p>
              <p>Price: ${{stock.price}}</p>
              <p>Volume: {{stock.volume}}</p>
              <p>Change Percent: {{stock.change_pct}}%</p>
              <div id="{{'chartContainer' + i}}" style="height: 370px; width: 100%; margin-left:auto;margin-right:auto;"></div>
            </mat-expansion-panel>
            </mat-card-content>
            <div *ngIf="isLoggedIn()">
            <mat-card-actions >
              <button mat-button (click)="addToPortfolio(stock.symbol, this.stockAmount)">Buy</button>
              <mat-form-field>
                <input matInput type="number" placeholder="Amount" value="value" name="amountInput" [(ngModel)]="stockAmount">
              </mat-form-field>
              
            </mat-card-actions>
          </div>
        </mat-card>
    </div>